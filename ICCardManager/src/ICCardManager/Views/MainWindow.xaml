<Window x:Class="ICCardManager.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:ICCardManager.ViewModels"
        xmlns:conv="clr-namespace:ICCardManager.Common"
        xmlns:cardReader="clr-namespace:ICCardManager.Infrastructure.CardReader"
        xmlns:app="clr-namespace:ICCardManager"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance Type=vm:MainViewModel}"
        Title="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„ÉâÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†"
        Height="700"
        Width="1350"
        MinWidth="{DynamicResource WindowMinWidth}"
        MinHeight="600"
        WindowStartupLocation="CenterScreen"
        AutomationProperties.Name="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„ÉâÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É† „É°„Ç§„É≥„Ç¶„Ç£„É≥„Éâ„Ç¶"
        AutomationProperties.HelpText="ËÅ∑Âì°Ë®º„Çí„Çø„ÉÉ„ÉÅ„Åó„Å¶„Åã„Çâ‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„Éâ„Çí„Çø„ÉÉ„ÉÅ„Åô„Çã„Å®Ë≤∏Âá∫„Åæ„Åü„ÅØËøîÂç¥„Åå„Åß„Åç„Åæ„Åô">

    <Window.Resources>
        <conv:IntToVisibilityConverter x:Key="IntToVisibilityConverter"/>
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <conv:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
    </Window.Resources>

    <Window.InputBindings>
        <!-- „Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà -->
        <KeyBinding Key="Escape" Command="{Binding CancelCommand}"/>
        <KeyBinding Key="F1" Command="{Binding OpenReportCommand}"/>
        <KeyBinding Key="F2" Command="{Binding OpenStaffManageCommand}"/>
        <KeyBinding Key="F3" Command="{Binding OpenCardManageCommand}"/>
        <KeyBinding Key="F4" Command="{Binding OpenDataExportImportCommand}"/>
        <KeyBinding Key="F5" Command="{Binding OpenSettingsCommand}"/>
        <KeyBinding Key="F6" Command="{Binding OpenSystemManageCommand}"/>
        <KeyBinding Key="F7" Command="{Binding OpenHelpCommand}"/>
    </Window.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- „Éò„ÉÉ„ÉÄ„Éº -->
        <Border Grid.Row="0" Background="{DynamicResource HeaderBackgroundBrush}" Padding="15,10">
            <DockPanel LastChildFill="False">
                <!-- „Çø„Ç§„Éà„É´ÔºàÂ∑¶ÂØÑ„ÅõÔºâ -->
                <TextBlock DockPanel.Dock="Left"
                           Text="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„ÉâÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†"
                           FontSize="{DynamicResource TitleFontSize}"
                           FontWeight="Bold"
                           Foreground="{DynamicResource OnPrimaryBrush}"
                           VerticalAlignment="Center"
                           Margin="0,0,30,0"/>

                <!-- „Éú„Çø„É≥Áæ§ÔºàÂè≥ÂØÑ„Åõ„ÉªÊäò„ÇäËøî„ÅóÂØæÂøúÔºâ -->
                <WrapPanel DockPanel.Dock="Right" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="Â∏≥Á•® (F1)" Margin="5,3"
                            Style="{StaticResource AccessibleButtonStyle}"
                            Command="{Binding OpenReportCommand}"
                            TabIndex="1"
                            AutomationProperties.Name="Â∏≥Á•®„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñã„Åè"
                            AutomationProperties.HelpText="Áâ©ÂìÅÂá∫Á¥çÁ∞ø„Çí‰ΩúÊàê„Åó„Åæ„Åô„ÄÇ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà: F1"
                            ToolTip="Â∏≥Á•®„ÇíÈñã„Åè (F1)"/>
                    <Button Content="ËÅ∑Âì°ÁÆ°ÁêÜ (F2)" Margin="5,3"
                            Style="{StaticResource AccessibleButtonStyle}"
                            Command="{Binding OpenStaffManageCommand}"
                            TabIndex="2"
                            AutomationProperties.Name="ËÅ∑Âì°ÁÆ°ÁêÜ„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñã„Åè"
                            AutomationProperties.HelpText="ËÅ∑Âì°„ÅÆÁôªÈå≤„ÉªÁ∑®ÈõÜ„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà: F2"
                            ToolTip="ËÅ∑Âì°ÁÆ°ÁêÜ„ÇíÈñã„Åè (F2)"/>
                    <Button Content="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„ÉâÁÆ°ÁêÜ (F3)" Margin="5,3"
                            Style="{StaticResource AccessibleButtonStyle}"
                            Command="{Binding OpenCardManageCommand}"
                            TabIndex="3"
                            AutomationProperties.Name="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„ÉâÁÆ°ÁêÜ„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñã„Åè"
                            AutomationProperties.HelpText="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„Éâ„ÅÆÁôªÈå≤„ÉªÁ∑®ÈõÜ„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà: F3"
                            ToolTip="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„ÉâÁÆ°ÁêÜ„ÇíÈñã„Åè (F3)"/>
                    <Button Content="„Éá„Éº„ÇøÂÖ•Âá∫Âäõ (F4)" Margin="5,3"
                            Style="{StaticResource AccessibleButtonStyle}"
                            Command="{Binding OpenDataExportImportCommand}"
                            TabIndex="4"
                            AutomationProperties.Name="„Éá„Éº„Çø„Ç®„ÇØ„Çπ„Éù„Éº„Éà/„Ç§„É≥„Éù„Éº„Éà„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñã„Åè"
                            AutomationProperties.HelpText="„Ç´„Éº„Éâ„ÉªËÅ∑Âì°„ÉªÂ±•Ê≠¥„ÅÆCSV„Ç®„ÇØ„Çπ„Éù„Éº„Éà/„Ç§„É≥„Éù„Éº„Éà„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà: F4"
                            ToolTip="„Éá„Éº„ÇøÂÖ•Âá∫Âäõ„ÇíÈñã„Åè (F4)"/>
                    <Button Content="Ë®≠ÂÆö (F5)" Margin="5,3"
                            Style="{StaticResource AccessibleButtonStyle}"
                            Command="{Binding OpenSettingsCommand}"
                            TabIndex="5"
                            AutomationProperties.Name="Ë®≠ÂÆö„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñã„Åè"
                            AutomationProperties.HelpText="„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆË®≠ÂÆö„ÇíÂ§âÊõ¥„Åó„Åæ„Åô„ÄÇ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà: F5"
                            ToolTip="Ë®≠ÂÆö„ÇíÈñã„Åè (F5)"/>
                    <Button Content="„Ç∑„Çπ„ÉÜ„É†ÁÆ°ÁêÜ (F6)" Margin="5,3"
                            Style="{StaticResource AccessibleButtonStyle}"
                            Command="{Binding OpenSystemManageCommand}"
                            TabIndex="6"
                            AutomationProperties.Name="„Ç∑„Çπ„ÉÜ„É†ÁÆ°ÁêÜ„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíÈñã„Åè"
                            AutomationProperties.HelpText="„Éá„Éº„Çø„Éô„Éº„Çπ„ÅÆ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éª„É™„Çπ„Éà„Ç¢„ÉªÊìç‰Ωú„É≠„Ç∞„ÇíÁÆ°ÁêÜ„Åó„Åæ„Åô„ÄÇ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà: F6"
                            ToolTip="„Ç∑„Çπ„ÉÜ„É†ÁÆ°ÁêÜ„ÇíÈñã„Åè (F6)"/>
                    <Button Content="„Éò„É´„Éó (F7)" Margin="5,3"
                            Style="{StaticResource AccessibleButtonStyle}"
                            Command="{Binding OpenHelpCommand}"
                            TabIndex="7"
                            AutomationProperties.Name="„Éò„É´„Éó„ÇíÈñã„Åè"
                            AutomationProperties.HelpText="„É¶„Éº„Ç∂„Éº„Éû„Éã„É•„Ç¢„É´Á≠â„ÅÆ„Éâ„Ç≠„É•„É°„É≥„Éà„Éï„Ç©„É´„ÉÄ„ÇíÈñã„Åç„Åæ„Åô„ÄÇ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà: F7"
                            ToolTip="„Éò„É´„Éó„ÇíÈñã„Åè (F7)"/>
                    <Button Content="ÁµÇ‰∫Ü" Margin="15,3,5,3"
                            Style="{StaticResource AccessibleButtonStyle}"
                            Command="{Binding ExitCommand}"
                            TabIndex="8"
                            AutomationProperties.Name="„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÁµÇ‰∫Ü"
                            AutomationProperties.HelpText="„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÁµÇ‰∫Ü„Åó„Åæ„Åô„ÄÇ"
                            ToolTip="„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÇíÁµÇ‰∫Ü"/>
                </WrapPanel>
            </DockPanel>
        </Border>

        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <!-- Issue #542: „Ç´„Éº„Éâ‰∏ÄË¶ß„ÅÆÂπÖ„ÇíÂ∫É„ÅèÔºàÈáëÈ°ç„ÉªË≤∏Âá∫ËÄÖ„Åæ„ÅßË°®Á§∫„ÄÅ„Éï„Ç©„É≥„Éà„Çµ„Ç§„Ç∫„Å´Âøú„Åò„Å¶ÂãïÁöÑË™øÊï¥Ôºâ -->
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- ‰∏≠Â§Æ„Ç®„É™„Ç¢ -->
            <Grid Grid.Column="0">
                <!-- ÂàùÊúüÁîªÈù¢Ôºà‰Ωø„ÅÑÊñπ„Ç¨„Ç§„ÉâÔºâ -->
                <Border Padding="40"
                        Background="{DynamicResource WaitingBackgroundBrush}"
                        Visibility="{Binding IsHistoryVisible, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=invert}"
                        AutomationProperties.Name="‰Ωø„ÅÑÊñπ„Ç¨„Ç§„Éâ">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" MaxWidth="600">
                        <TextBlock Text="üöÉ"
                                   FontSize="{DynamicResource IconFontSize}"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,20"/>
                        <TextBlock Text="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„ÉâÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†"
                                   FontSize="{DynamicResource TitleFontSize}"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,30"/>

                        <!-- ‰Ωø„ÅÑÊñπ„Ç¨„Ç§„Éâ -->
                        <Border Background="White" CornerRadius="8" Padding="25" Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="üìñ ‰Ωø„ÅÑÊñπ"
                                           FontSize="{DynamicResource LargeFontSize}"
                                           FontWeight="Bold"
                                           Margin="0,0,0,15"/>

                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="1Ô∏è‚É£" FontSize="{DynamicResource BaseFontSize}" VerticalAlignment="Top"/>
                                    <TextBlock Grid.Column="1" TextWrapping="Wrap" FontSize="{DynamicResource BaseFontSize}">
                                        <Run FontWeight="Bold">Ë≤∏Âá∫„ÉªËøîÂç¥Ôºö</Run>
                                        <Run>ËÅ∑Âì°Ë®º„Çí„Çø„ÉÉ„ÉÅ ‚Üí ‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„Éâ„Çí„Çø„ÉÉ„ÉÅ</Run>
                                    </TextBlock>
                                </Grid>

                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="2Ô∏è‚É£" FontSize="{DynamicResource BaseFontSize}" VerticalAlignment="Top"/>
                                    <TextBlock Grid.Column="1" TextWrapping="Wrap" FontSize="{DynamicResource BaseFontSize}">
                                        <Run FontWeight="Bold">Â±•Ê≠¥Á¢∫Ë™çÔºö</Run>
                                        <Run>‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„Éâ„Çí„Çø„ÉÉ„ÉÅ„ÄÅ„Åæ„Åü„ÅØÂè≥„ÅÆ„Ç´„Éº„Éâ‰∏ÄË¶ß„Çí„ÇØ„É™„ÉÉ„ÇØ</Run>
                                    </TextBlock>
                                </Grid>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="40"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="3Ô∏è‚É£" FontSize="{DynamicResource BaseFontSize}" VerticalAlignment="Top"/>
                                    <TextBlock Grid.Column="1" TextWrapping="Wrap" FontSize="{DynamicResource BaseFontSize}">
                                        <Run FontWeight="Bold">Ë™§Êìç‰Ωú„ÅÆ‰øÆÊ≠£Ôºö</Run>
                                        <Run>30Áßí‰ª•ÂÜÖ„Å´Âêå„Åò„Ç´„Éº„Éâ„ÇíÂÜç„Çø„ÉÉ„ÉÅ„Åô„Çã„Å®ÈÄÜ„ÅÆÂá¶ÁêÜÔºàË≤∏Âá∫‚ÜíËøîÂç¥„ÄÅËøîÂç¥‚ÜíË≤∏Âá∫Ôºâ„Åå„Åß„Åç„Åæ„Åô</Run>
                                    </TextBlock>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- „Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà -->
                        <Border Background="{DynamicResource ReturnBackgroundBrush}" CornerRadius="8" Padding="20">
                            <StackPanel>
                                <TextBlock Text="‚å®Ô∏è „Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà„Ç≠„Éº"
                                           FontSize="{DynamicResource BaseFontSize}"
                                           FontWeight="Bold"
                                           Margin="0,0,0,10"/>
                                <WrapPanel>
                                    <TextBlock Text="F1: Â∏≥Á•®" FontSize="{DynamicResource SmallFontSize}" Margin="0,0,20,5"/>
                                    <TextBlock Text="F2: ËÅ∑Âì°ÁÆ°ÁêÜ" FontSize="{DynamicResource SmallFontSize}" Margin="0,0,20,5"/>
                                    <TextBlock Text="F3: „Ç´„Éº„ÉâÁÆ°ÁêÜ" FontSize="{DynamicResource SmallFontSize}" Margin="0,0,20,5"/>
                                    <TextBlock Text="F4: „Éá„Éº„ÇøÂÖ•Âá∫Âäõ" FontSize="{DynamicResource SmallFontSize}" Margin="0,0,20,5"/>
                                    <TextBlock Text="F5: Ë®≠ÂÆö" FontSize="{DynamicResource SmallFontSize}" Margin="0,0,20,5"/>
                                    <TextBlock Text="F6: „Ç∑„Çπ„ÉÜ„É†ÁÆ°ÁêÜ" FontSize="{DynamicResource SmallFontSize}" Margin="0,0,0,5"/>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Â±•Ê≠¥Ë°®Á§∫„Ç®„É™„Ç¢ -->
                <Border Padding="15"
                        Background="White"
                        Visibility="{Binding IsHistoryVisible, Converter={StaticResource BoolToVisibilityConverter}}"
                        AutomationProperties.Name="Âà©Áî®Â±•Ê≠¥Ë°®Á§∫„Ç®„É™„Ç¢">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- „Ç´„Éº„ÉâÊÉÖÂ†±„Éò„ÉÉ„ÉÄ„Éº -->
                        <Border Grid.Row="0" Background="{DynamicResource ReturnBackgroundBrush}" CornerRadius="4" Padding="15" Margin="0,0,0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Orientation="Horizontal">
                                    <TextBlock Text="{Binding HistoryCard.CardType}"
                                               FontSize="{DynamicResource LargeFontSize}"
                                               FontWeight="Bold"
                                               VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding HistoryCard.CardNumber}"
                                               FontSize="{DynamicResource LargeFontSize}"
                                               Margin="15,0,0,0"
                                               VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding HistoryCard.Note}"
                                               FontSize="{DynamicResource BaseFontSize}"
                                               Foreground="{DynamicResource SecondaryTextBrush}"
                                               Margin="20,0,0,0"
                                               VerticalAlignment="Center"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,20,0">
                                    <TextBlock Text="ÁèæÂú®ÊÆãÈ´ò:"
                                               FontSize="{DynamicResource BaseFontSize}"
                                               VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding HistoryCurrentBalance, StringFormat={}{0:N0}ÂÜÜ}"
                                               FontSize="{DynamicResource TitleFontSize}"
                                               FontWeight="Bold"
                                               Foreground="{DynamicResource InfoTextBrush}"
                                               Margin="10,0,0,0"
                                               VerticalAlignment="Center"/>
                                </StackPanel>

                                <Button Grid.Column="2"
                                        Content="‚úï Èñâ„Åò„Çã"
                                        Command="{Binding CloseHistoryCommand}"
                                        Padding="15,8"
                                        AutomationProperties.Name="Â±•Ê≠¥„ÇíÈñâ„Åò„Çã"
                                        ToolTip="Â±•Ê≠¥Ë°®Á§∫„ÇíÈñâ„Åò„Çã"/>
                            </Grid>
                        </Border>

                        <!-- ÊúüÈñìÈÅ∏Êäû -->
                        <Grid Grid.Row="1" Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <TextBlock Text="Ë°®Á§∫ÊúüÈñì:"
                                           VerticalAlignment="Center"
                                           Margin="0,0,10,0"/>
                                <Border Background="{DynamicResource ReturnBackgroundBrush}"
                                        CornerRadius="4"
                                        Padding="15,8">
                                    <TextBlock Text="{Binding HistoryPeriodDisplay}"
                                               FontSize="{DynamicResource LargeFontSize}"
                                               FontWeight="Bold"
                                               Foreground="{DynamicResource InfoTextBrush}"/>
                                </Border>
                            </StackPanel>

                            <!-- ÊúàÈÅ∏Êäû„Éú„Çø„É≥Ôºà‰ΩøÁî®È†ªÂ∫¶È†Ü: ÂÖàÊúà > ‰ªäÊúà„ÄÇÂ∏≥Á•®ÁîªÈù¢„Å®Âêå„ÅòÈ†ÜÂ∫èÔºâ -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button Content="ÂÖàÊúà"
                                        Command="{Binding HistorySetLastMonthCommand}"
                                        Padding="12,6"
                                        Margin="0,0,5,0"
                                        ToolTip="ÂÖàÊúà„ÅÆÂ±•Ê≠¥„ÇíË°®Á§∫"/>
                                <Button Content="‰ªäÊúà"
                                        Command="{Binding HistorySetThisMonthCommand}"
                                        Padding="12,6"
                                        Margin="0,0,5,0"
                                        ToolTip="‰ªäÊúà„ÅÆÂ±•Ê≠¥„ÇíË°®Á§∫"/>
                                <Button x:Name="HistoryOtherMonthButton"
                                        Content="„Åù„ÅÆ‰ªñ„ÅÆÊúà..."
                                        Command="{Binding HistoryOpenMonthSelectorCommand}"
                                        Padding="12,6"
                                        ToolTip="‰ªªÊÑè„ÅÆÂπ¥Êúà„ÇíÈÅ∏Êäû"/>

                                <!-- Ë°åÊìç‰Ωú„Éú„Çø„É≥ÔºàIssue #635Ôºâ -->
                                <Border Width="1" Background="{DynamicResource DividerBrush}" Margin="10,2"/>
                                <Button Content="Ôºã Ë°å„ÇíËøΩÂä†"
                                        Command="{Binding AddLedgerRowCommand}"
                                        Padding="12,6"
                                        ToolTip="Â±•Ê≠¥„Å´Êñ∞„Åó„ÅÑË°å„ÇíÊåøÂÖ•„Åó„Åæ„Åô"
                                        AutomationProperties.Name="Â±•Ê≠¥Ë°å„ÇíËøΩÂä†"
                                        AutomationProperties.HelpText="ÊâãÂãï„ÅßÂ±•Ê≠¥Ë°å„ÇíËøΩÂä†„Åó„Åæ„ÅôÔºàÊó•‰ªò„ÉªÊëòË¶Å„ÉªÈáëÈ°çÁ≠â„ÇíÂÖ•ÂäõÔºâ"/>

                                <!-- Áµ±Âêà„Éú„Çø„É≥ÔºàIssue #548Ôºâ -->
                                <Border Width="1" Background="{DynamicResource DividerBrush}" Margin="10,2"/>
                                <Button Content="üì¶ „ÉÅ„Çß„ÉÉ„ÇØ„Åó„ÅüÂ±•Ê≠¥„ÇíÁµ±Âêà"
                                        Command="{Binding MergeHistoryLedgersCommand}"
                                        Padding="12,6"
                                        ToolTip="„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„ÅßÈÅ∏„Çì„Å†Â±•Ê≠¥„Çí1„Å§„Å´Áµ±Âêà„Åó„Åæ„Åô"
                                        AutomationProperties.Name="„ÉÅ„Çß„ÉÉ„ÇØ„Åó„ÅüÂ±•Ê≠¥„ÇíÁµ±Âêà"
                                        AutomationProperties.HelpText="„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„ÅßÁµ±Âêà„Åó„Åü„ÅÑÂ±•Ê≠¥„ÇíÈÅ∏„Çì„Åß„Åã„Çâ„Åì„ÅÆ„Éú„Çø„É≥„ÇíÊäº„Åô„Å®„ÄÅ1„Å§„ÅÆÂ±•Ê≠¥„Å´„Åæ„Å®„ÇÅ„Åæ„Åô"/>
                                <Button Content="‚Ü© Áµ±Âêà„ÇíÂÖÉ„Å´Êàª„Åô"
                                        Command="{Binding UndoMergeHistoryLedgersCommand}"
                                        Padding="12,6"
                                        ToolTip="ÈÅéÂéª„ÅÆÁµ±ÂêàÊìç‰Ωú„ÇíÂÖÉ„Å´Êàª„Åó„Åæ„Åô"
                                        AutomationProperties.Name="Áµ±Âêà„ÇíÂÖÉ„Å´Êàª„Åô"
                                        AutomationProperties.HelpText="ÈÅéÂéª„ÅÆÁµ±ÂêàÊìç‰Ωú„ÇíÈÅ∏„Çì„ÅßÂèñ„ÇäÊ∂à„Åó„Å¶ÂÖÉ„ÅÆÁä∂ÊÖã„Å´Êàª„Åó„Åæ„Åô"/>

                                <!-- ÊúàÈÅ∏Êäû„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó -->
                                <Popup IsOpen="{Binding IsHistoryMonthSelectorOpen}"
                                       PlacementTarget="{Binding ElementName=HistoryOtherMonthButton}"
                                       Placement="Bottom"
                                       StaysOpen="False"
                                       AllowsTransparency="True"
                                       AutomationProperties.Name="ÊúàÈÅ∏Êäû„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó"
                                       AutomationProperties.HelpText="Âπ¥„Å®Êúà„ÇíÈÅ∏„Çì„Åß„ÄåÈÅ©Áî®„Äç„ÇíÊäº„Åô„Å®„ÄÅ„Åù„ÅÆÊúà„ÅÆÂ±•Ê≠¥„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô">
                                    <Border Background="White"
                                            BorderBrush="{DynamicResource SubtleBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="4"
                                            Padding="15"
                                            Margin="0,5,0,0">
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.3"/>
                                        </Border.Effect>
                                        <StackPanel>
                                            <TextBlock Text="Êúà„ÇíÈÅ∏Êäû" FontWeight="Bold" Margin="0,0,0,10"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                <ComboBox ItemsSource="{Binding HistoryAvailableYears}"
                                                          SelectedItem="{Binding HistorySelectedYear}"
                                                          Width="80"
                                                          Padding="8"
                                                          AutomationProperties.Name="Âπ¥„ÅÆÈÅ∏Êäû"/>
                                                <TextBlock Text="Âπ¥" VerticalAlignment="Center" Margin="5,0,15,0"/>
                                                <ComboBox ItemsSource="{Binding HistoryAvailableMonths}"
                                                          SelectedItem="{Binding HistorySelectedMonth}"
                                                          Width="60"
                                                          Padding="8"
                                                          AutomationProperties.Name="Êúà„ÅÆÈÅ∏Êäû"/>
                                                <TextBlock Text="Êúà" VerticalAlignment="Center" Margin="5,0,0,0"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                                <Button Content="„Ç≠„É£„É≥„Çª„É´"
                                                        Command="{Binding HistoryCloseMonthSelectorCommand}"
                                                        Padding="10,5"
                                                        Margin="0,0,10,0"
                                                        AutomationProperties.Name="ÊúàÈÅ∏Êäû„Çí„Ç≠„É£„É≥„Çª„É´"/>
                                                <Button Content="ÈÅ©Áî®"
                                                        Command="{Binding HistoryApplySelectedMonthCommand}"
                                                        Padding="15,5"
                                                        Background="{DynamicResource HeaderBackgroundBrush}"
                                                        Foreground="{DynamicResource OnPrimaryBrush}"
                                                        AutomationProperties.Name="ÈÅ∏Êäû„Åó„ÅüÊúà„ÇíÈÅ©Áî®"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </Popup>
                            </StackPanel>
                        </Grid>

                        <!-- Â±•Ê≠¥‰∏ÄË¶ß -->
                        <DataGrid Grid.Row="2"
                                  x:Name="HistoryDataGrid"
                                  ItemsSource="{Binding HistoryLedgers}"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  SelectionMode="Single"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  GridLinesVisibility="Horizontal"
                                  HeadersVisibility="Column"
                                  RowHeaderWidth="0"
                                  AlternatingRowBackground="{DynamicResource AlternatingRowBrush}"
                                  AutomationProperties.Name="Âà©Áî®Â±•Ê≠¥‰∏ÄË¶ß"
                                  AutomationProperties.HelpText="„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„ÅßÁµ±Âêà„Åó„Åü„ÅÑÂ±•Ê≠¥„ÇíÈÅ∏Êäû„Åó„ÄÅÁµ±Âêà„Éú„Çø„É≥„ÇíÊäº„Åó„Åæ„Åô">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="ÈÅ∏Êäû" Width="45">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding IsChecked, UpdateSourceTrigger=PropertyChanged}"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"
                                                      AutomationProperties.Name="Áµ±ÂêàÂØæË±°„Å®„Åó„Å¶ÈÅ∏Êäû"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="Êó•‰ªò" Binding="{Binding DateDisplay}" Width="90"/>
                                <DataGridTextColumn Header="ÊëòË¶Å" Binding="{Binding Summary}" Width="*"/>
                                <DataGridTextColumn Header="ÂèóÂÖ•" Width="75">
                                    <DataGridTextColumn.Binding>
                                        <Binding Path="IncomeDisplay"/>
                                    </DataGridTextColumn.Binding>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="ÊâïÂá∫" Width="75">
                                    <DataGridTextColumn.Binding>
                                        <Binding Path="ExpenseDisplay"/>
                                    </DataGridTextColumn.Binding>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="ÊÆãÈ´ò" Width="85">
                                    <DataGridTextColumn.Binding>
                                        <Binding Path="BalanceDisplay"/>
                                    </DataGridTextColumn.Binding>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Âà©Áî®ËÄÖ" Binding="{Binding StaffName}" Width="80"/>
                                <DataGridTextColumn Header="ÂÇôËÄÉ" Binding="{Binding Note}" Width="80"/>
                                <!-- Issue #750: ÂâäÈô§„Éú„Çø„É≥„ÅØÂ§âÊõ¥„ÉÄ„Ç§„Ç¢„É≠„Ç∞ÂÜÖ„Å´ÁßªÂãï -->
                                <DataGridTemplateColumn Header="Êìç‰Ωú" Width="130">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="Ë©≥Á¥∞"
                                                        Command="{Binding DataContext.ShowLedgerDetailCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                        CommandParameter="{Binding}"
                                                        IsEnabled="{Binding HasDetails}"
                                                        Padding="8,2"
                                                        Margin="0,0,3,0"
                                                        ToolTip="Âà©Áî®Ë©≥Á¥∞„ÇíË°®Á§∫"/>
                                                <Button Content="Â§âÊõ¥"
                                                        Command="{Binding DataContext.EditLedgerCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                        CommandParameter="{Binding}"
                                                        Padding="8,2"
                                                        ToolTip="ÊëòË¶Å„ÉªÂÇôËÄÉ„ÉªÂà©Áî®ËÄÖ„ÉªÊó•‰ªò„ÉªÈáëÈ°ç„ÇíÂ§âÊõ¥"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>

                            <!-- Ë≤∏Âá∫‰∏≠„É¨„Ç≥„Éº„Éâ„ÅÆ„Çπ„Çø„Ç§„É´ -->
                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsLentRecord}" Value="True">
                                            <Setter Property="Background" Value="{DynamicResource LendingBackgroundBrush}"/>
                                            <Setter Property="FontStyle" Value="Italic"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                        </DataGrid>

                        <!-- „Éï„ÉÉ„Çø„ÉºÔºà„Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥Ôºâ -->
                        <Border Grid.Row="3"
                                Background="{DynamicResource NeutralBackgroundBrush}"
                                CornerRadius="4"
                                Padding="10,8"
                                Margin="0,10,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
                                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                    <Button Content="‚èÆ"
                                            Command="{Binding HistoryGoToFirstPageCommand}"
                                            Padding="8,4"
                                            MinWidth="32"
                                            ToolTip="ÊúÄÂàù„ÅÆ„Éö„Éº„Ç∏„Å∏"/>
                                    <Button Content="‚óÄ"
                                            Command="{Binding HistoryGoToPrevPageCommand}"
                                            Padding="8,4"
                                            MinWidth="32"
                                            Margin="5,0,0,0"
                                            ToolTip="Ââç„ÅÆ„Éö„Éº„Ç∏„Å∏"/>

                                    <TextBlock Text="„Éö„Éº„Ç∏"
                                               VerticalAlignment="Center"
                                               Margin="15,0,5,0"/>
                                    <Border Background="White"
                                            BorderBrush="{DynamicResource SubtleBorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="2"
                                            Padding="10,4">
                                        <TextBlock Text="{Binding HistoryPageDisplay}"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center"/>
                                    </Border>

                                    <Button Content="‚ñ∂"
                                            Command="{Binding HistoryGoToNextPageCommand}"
                                            Padding="8,4"
                                            MinWidth="32"
                                            Margin="15,0,0,0"
                                            ToolTip="Ê¨°„ÅÆ„Éö„Éº„Ç∏„Å∏"/>
                                    <Button Content="‚è≠"
                                            Command="{Binding HistoryGoToLastPageCommand}"
                                            Padding="8,4"
                                            MinWidth="32"
                                            Margin="5,0,0,0"
                                            ToolTip="ÊúÄÂæå„ÅÆ„Éö„Éº„Ç∏„Å∏"/>
                                </StackPanel>

                                <!-- ‰ª∂Êï∞Ë°®Á§∫ -->
                                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding HistoryStatusMessage}"
                                               FontSize="{DynamicResource SmallFontSize}"
                                               Foreground="{DynamicResource SecondaryTextBrush}"
                                               VerticalAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
            </Grid>

            <!-- Âè≥„Çµ„Ç§„Éâ„Éê„ÉºÔºà„Ç´„Éº„ÉâÊÆãÈ´ò„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâÔºâ -->
            <!-- Issue #542: „Çµ„Ç§„Éâ„Éê„ÉºÂπÖ„Çí„Éï„Ç©„É≥„Éà„Çµ„Ç§„Ç∫„Å´Âøú„Åò„Å¶ÂãïÁöÑË™øÊï¥ -->
            <Border Grid.Column="1" Background="{DynamicResource NeutralBackgroundBrush}" Padding="15"
                    Width="{DynamicResource SidebarWidth}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <!-- Issue #541: „Ç´„Éº„Éâ‰∏ÄË¶ß„Å®„Ç∑„Çπ„ÉÜ„É†Ë≠¶Âëä„ÅÆÈ´ò„ÅïÊØîÁéá„Çí7:3„Å´Ë™øÊï¥ -->
                        <RowDefinition Height="7*" MinHeight="100"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="3*" MaxHeight="200"/>
                    </Grid.RowDefinitions>

                    <!-- „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Éò„ÉÉ„ÉÄ„Éº -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="üí≥ „Ç´„Éº„Éâ‰∏ÄË¶ß"
                                   FontSize="{DynamicResource BaseFontSize}"
                                   FontWeight="Bold"
                                   VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding CardBalanceDashboard.Count, StringFormat=' ({0}Êûö)'}"
                                   FontSize="{DynamicResource SmallFontSize}"
                                   Foreground="{DynamicResource SecondaryTextBrush}"
                                   VerticalAlignment="Center"
                                   Margin="5,0,0,0"/>
                    </StackPanel>

                    <!-- „ÇΩ„Éº„ÉàÈÅ∏Êäû -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="‰∏¶„Å≥È†Ü:"
                                   FontSize="{DynamicResource SmallFontSize}"
                                   VerticalAlignment="Center"
                                   Margin="0,0,5,0"/>
                        <ComboBox SelectedValue="{Binding DashboardSortOrder}"
                                  SelectedValuePath="Tag"
                                  FontSize="{DynamicResource SmallFontSize}"
                                  Width="130"
                                  TabIndex="9"
                                  AutomationProperties.Name="„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÅÆ‰∏¶„Å≥È†Ü"
                                  ToolTip="„Ç´„Éº„Éâ‰∏ÄË¶ß„ÅÆ‰∏¶„Å≥È†Ü„ÇíÂ§âÊõ¥">
                            <ComboBoxItem Content="ÊÆãÈ´òÔºàÂ∞ë„Å™„ÅÑÈ†ÜÔºâ" Tag="{x:Static vm:DashboardSortOrder.BalanceAscending}"/>
                            <ComboBoxItem Content="ÊÆãÈ´òÔºàÂ§ö„ÅÑÈ†ÜÔºâ" Tag="{x:Static vm:DashboardSortOrder.BalanceDescending}"/>
                            <ComboBoxItem Content="„Ç´„Éº„ÉâÂêçÈ†Ü" Tag="{x:Static vm:DashboardSortOrder.CardName}"/>
                            <ComboBoxItem Content="ÊúÄÁµÇÂà©Áî®Êó•È†Ü" Tag="{x:Static vm:DashboardSortOrder.LastUsageDate}"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- „Ç´„Éº„Éâ‰∏ÄË¶ß -->
                    <ListView Grid.Row="2"
                              ItemsSource="{Binding CardBalanceDashboard}"
                              SelectedItem="{Binding SelectedDashboardItem}"
                              BorderThickness="0"
                              Background="Transparent"
                              TabIndex="10"
                              KeyboardNavigation.TabNavigation="Once"
                              AutomationProperties.Name="„Ç´„Éº„Éâ‰∏ÄË¶ß"
                              AutomationProperties.HelpText="„Ç´„Éº„Éâ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åæ„Åü„ÅØEnter„Ç≠„Éº„ÅßÂ±•Ê≠¥„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ‰∏ä‰∏ãÁü¢Âç∞„Ç≠„Éº„ÅßÈÅ∏Êäû„ÇíÁßªÂãï„Åß„Åç„Åæ„Åô">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="0"/>
                                <Setter Property="Margin" Value="0,2"/>
                                <Setter Property="Focusable" Value="True"/>
                                <Setter Property="AutomationProperties.Name" Value="{Binding DisplayName}"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListViewItem">
                                            <Border x:Name="ItemBorder"
                                                    BorderThickness="2"
                                                    BorderBrush="Transparent"
                                                    CornerRadius="4">
                                                <ContentPresenter/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsKeyboardFocused" Value="True">
                                                    <Setter TargetName="ItemBorder" Property="BorderBrush" Value="{DynamicResource HeaderBackgroundBrush}"/>
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="ItemBorder" Property="BorderBrush" Value="{DynamicResource PrimaryBrush}"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.InputBindings>
                            <KeyBinding Key="Enter" Command="{Binding OpenCardHistoryFromDashboardCommand}" CommandParameter="{Binding SelectedDashboardItem}"/>
                            <KeyBinding Key="Space" Command="{Binding OpenCardHistoryFromDashboardCommand}" CommandParameter="{Binding SelectedDashboardItem}"/>
                        </ListView.InputBindings>
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Border CornerRadius="4"
                                        Padding="10,8"
                                        Cursor="Hand"
                                        Background="{Binding RowBackgroundColor}">
                                    <Border.InputBindings>
                                        <MouseBinding MouseAction="LeftClick"
                                                      Command="{Binding DataContext.OpenCardHistoryFromDashboardCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                                      CommandParameter="{Binding}"/>
                                    </Border.InputBindings>
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="White"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsBalanceWarning}" Value="True">
                                                    <Setter Property="Background" Value="{DynamicResource ErrorBackgroundBrush}"/>
                                                </DataTrigger>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="BorderBrush" Value="{DynamicResource HeaderBackgroundBrush}"/>
                                                    <Setter Property="BorderThickness" Value="1"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <!-- Issue #542: 2Ë°å„É¨„Ç§„Ç¢„Ç¶„ÉàÔºàDockPanel„ÅßÂ∑¶Âè≥ÈÖçÁΩÆ„Åó„ÄÅÂ§ß„Åç„Å™„Éï„Ç©„É≥„Éà„Åß„ÇÇÂ¥©„Çå„Å™„ÅÑ„Çà„ÅÜ„Å´Ôºâ -->
                                    <StackPanel>
                                        <!-- 1Ë°åÁõÆ: „Ç´„Éº„ÉâÂêç + ÊÆãÈ´ò -->
                                        <DockPanel>
                                            <!-- Ë≠¶Âëä„Ç¢„Ç§„Ç≥„É≥ -->
                                            <TextBlock DockPanel.Dock="Left"
                                                       Text="{Binding WarningIcon}"
                                                       FontSize="{DynamicResource LargeFontSize}"
                                                       VerticalAlignment="Center"
                                                       Margin="0,0,8,0"
                                                       Foreground="{DynamicResource ErrorBorderBrush}"
                                                       ToolTip="ÊÆãÈ´òË≠¶Âëä"
                                                       Visibility="{Binding IsBalanceWarning, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                            <!-- ÊÆãÈ´òÔºàÂè≥ÂØÑ„ÅõÔºâ -->
                                            <TextBlock DockPanel.Dock="Right"
                                                       Text="{Binding BalanceDisplay}"
                                                       FontWeight="Bold"
                                                       FontSize="{DynamicResource SmallFontSize}"
                                                       VerticalAlignment="Center">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="{DynamicResource WaitingForegroundBrush}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsBalanceWarning}" Value="True">
                                                                <Setter Property="Foreground" Value="{DynamicResource ErrorBorderBrush}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                            <!-- „Ç´„Éº„ÉâÂêç -->
                                            <TextBlock FontWeight="Bold"
                                                       FontSize="{DynamicResource SmallFontSize}"
                                                       TextTrimming="CharacterEllipsis"
                                                       VerticalAlignment="Center">
                                                <Run Text="{Binding CardType, Mode=OneWay}"/>
                                                <Run Text=" "/>
                                                <Run Text="{Binding CardNumber, Mode=OneWay}"/>
                                            </TextBlock>
                                        </DockPanel>
                                        <!-- 2Ë°åÁõÆ: ÊúÄÁµÇÂà©Áî®Êó•ÔºàÂ∑¶Ôºâ + Ë≤∏Âá∫Áä∂ÊÖãÔºàÂè≥Ôºâ -->
                                        <DockPanel>
                                            <!-- Ë≤∏Âá∫Áä∂ÊÖãÔºàÂè≥ÂØÑ„ÅõÔºâ -->
                                            <TextBlock DockPanel.Dock="Right"
                                                       FontSize="{DynamicResource SmallFontSize}"
                                                       Margin="5,0,0,0">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Foreground" Value="{DynamicResource SuccessActionBrush}"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding IsLent}" Value="True">
                                                                <Setter Property="Foreground" Value="{DynamicResource WarningActionBrush}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                                <Run Text="{Binding LentStatusIcon, Mode=OneWay}"/>
                                                <Run Text=" "/>
                                                <Run Text="{Binding LentInfoDisplay, Mode=OneWay}"/>
                                            </TextBlock>
                                            <!-- ÊúÄÁµÇÂà©Áî®Êó•ÔºàÂ∑¶ÂØÑ„Åõ„ÄÅÁúÅÁï•ÂèØËÉΩÔºâ -->
                                            <TextBlock FontSize="{DynamicResource SmallFontSize}"
                                                       Foreground="{DynamicResource SecondaryTextBrush}"
                                                       TextTrimming="CharacterEllipsis">
                                                <Run Text="{Binding LastUsageDateDisplay, Mode=OneWay}"/>
                                            </TextBlock>
                                        </DockPanel>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>

                    <!-- Ë≠¶Âëä„Ç®„É™„Ç¢ -->
                    <TextBlock Grid.Row="3"
                               Text="‚ö† „Ç∑„Çπ„ÉÜ„É†Ë≠¶Âëä"
                               FontSize="{DynamicResource BaseFontSize}"
                               FontWeight="Bold"
                               Margin="0,15,0,10"
                               Foreground="{DynamicResource ErrorBorderBrush}"
                               Visibility="{Binding WarningMessages.Count, Converter={StaticResource IntToVisibilityConverter}, Mode=OneWay}"/>

                    <!-- Issue #541: Ë≠¶Âëä„Ç®„É™„Ç¢„Å´„Çπ„ÇØ„É≠„Éº„É´Ê©üËÉΩ„ÇíËøΩÂä†ÔºàÈ´ò„ÅïÂà∂ÈôêÂØæÂøúÔºâ -->
                    <ScrollViewer Grid.Row="4"
                                  VerticalScrollBarVisibility="Auto"
                                  HorizontalScrollBarVisibility="Disabled">
                        <!-- Issue #672: Ë≠¶Âëä„Çí„ÇØ„É™„ÉÉ„ÇØÂèØËÉΩ„Å´ -->
                        <ItemsControl ItemsSource="{Binding WarningMessages}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border CornerRadius="4"
                                            Margin="0,2" Padding="10,8"
                                            Cursor="Hand"
                                            AutomationProperties.Name="{Binding DisplayText}">
                                        <Border.InputBindings>
                                            <MouseBinding MouseAction="LeftClick"
                                                          Command="{Binding DataContext.HandleWarningClickCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                          CommandParameter="{Binding}"/>
                                        </Border.InputBindings>
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Background" Value="{DynamicResource LendingBackgroundBrush}"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="{DynamicResource LendingBorderBrush}"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <TextBlock Text="{Binding DisplayText}"
                                                   TextWrapping="Wrap"
                                                   FontSize="{DynamicResource SmallFontSize}"/>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>

        <!-- Âá¶ÁêÜ‰∏≠„Ç™„Éº„Éê„Éº„É¨„Ç§ -->
        <Border Grid.Row="1" Background="{DynamicResource OverlayBrush}"
                Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                <TextBlock Text="{Binding BusyMessage}"
                           Foreground="{DynamicResource OnPrimaryBrush}"
                           FontSize="{DynamicResource LargeFontSize}"
                           Margin="0,15,0,0"
                           HorizontalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- Êìç‰Ωú„Éí„É≥„Éà + „Éá„Éê„ÉÉ„Ç∞„Éú„Çø„É≥ -->
        <Border Grid.Row="2" Background="{DynamicResource ReturnBackgroundBrush}" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" FontSize="{DynamicResource SmallFontSize}" Foreground="{DynamicResource InfoTextBrush}" VerticalAlignment="Center">
                    <Run Text="Êìç‰Ωú: "/>
                    <Run Text="ËÅ∑Âì°Ë®º„Çø„ÉÉ„ÉÅ ‚Üí ‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„Éâ„Çø„ÉÉ„ÉÅ „ÅßË≤∏Âá∫/ËøîÂç¥"/>
                    <Run Text=" | "/>
                    <Run Text="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„Éâ„ÅÆ„Åø„Çø„ÉÉ„ÉÅ „ÅßÂ±•Ê≠¥Ë°®Á§∫"/>
                    <Run Text=" | "/>
                    <Run Text="[Esc] „Ç≠„É£„É≥„Çª„É´"/>
                </TextBlock>

                <!-- „Éá„Éê„ÉÉ„Ç∞Áî®„Éú„Çø„É≥ (DEBUG „Éì„É´„Éâ„ÅÆ„ÅøË°®Á§∫: Issue #289) -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="20,0,0,0"
                            Visibility="{Binding Source={x:Static app:App.IsDebugBuild}, Converter={StaticResource BoolToVisibilityConverter}}">
                    <TextBlock Text="[DEBUG]" FontSize="{DynamicResource SmallFontSize}" Foreground="Red" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <Button Content="ËÅ∑Âì°Ë®º" Command="{Binding SimulateStaffCardCommand}" Padding="10,3" Margin="0,0,5,0"/>
                    <Button Content="‰∫§ÈÄöÁ≥ªIC„Ç´„Éº„Éâ" Command="{Binding SimulateIcCardCommand}" Padding="10,3" Margin="0,0,5,0"/>
                    <Button Content="‰ªÆÊÉ≥„Çø„ÉÉ„ÉÅ" Command="{Binding OpenVirtualCardCommand}" Padding="10,3"
                            Background="#E8F5E9" ToolTip="Â±•Ê≠¥„Éá„Éº„Çø„ÇíÊåáÂÆö„Åó„Å¶‰ªÆÊÉ≥„Çø„ÉÉ„ÉÅ„ÇíÂÆüË°å"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- „Çπ„ÉÜ„Éº„Çø„Çπ„Éê„Éº -->
        <StatusBar Grid.Row="3">
            <StatusBarItem>
                <TextBlock>
                    <Run Text="Áä∂ÊÖã: "/>
                    <Run Text="{Binding CurrentState, Mode=OneWay}"/>
                </TextBlock>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock>
                    <Run Text="ÁôªÈå≤„Ç´„Éº„Éâ: "/>
                    <Run Text="{Binding CardBalanceDashboard.Count, Mode=OneWay}"/>
                    <Run Text=" Êûö"/>
                </TextBlock>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock>
                    <Run Text="Ë≤∏Âá∫‰∏≠: "/>
                    <Run Text="{Binding LentCards.Count, Mode=OneWay}"/>
                    <Run Text=" Êûö"/>
                </TextBlock>
            </StatusBarItem>
            <Separator/>
            <!-- „Ç´„Éº„Éâ„É™„Éº„ÉÄ„ÉºÊé•Á∂öÁä∂ÊÖã -->
            <StatusBarItem AutomationProperties.Name="„Ç´„Éº„Éâ„É™„Éº„ÉÄ„ÉºÊé•Á∂öÁä∂ÊÖã">
                <StackPanel Orientation="Horizontal">
                    <!-- Êé•Á∂öÁä∂ÊÖã„Ç¢„Ç§„Ç≥„É≥ -->
                    <TextBlock x:Name="ConnectionIcon" VerticalAlignment="Center" Margin="0,0,5,0">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Text" Value="üîó"/>
                                <Setter Property="Foreground" Value="{DynamicResource SuccessActionBrush}"/>
                                <Setter Property="ToolTip" Value="„Ç´„Éº„Éâ„É™„Éº„ÉÄ„ÉºÊé•Á∂ö‰∏≠"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding CardReaderConnectionState}" Value="{x:Static cardReader:CardReaderConnectionState.Disconnected}">
                                        <Setter Property="Text" Value="üîå"/>
                                        <Setter Property="Foreground" Value="{DynamicResource ErrorBorderBrush}"/>
                                        <Setter Property="ToolTip" Value="„Ç´„Éº„Éâ„É™„Éº„ÉÄ„ÉºÂàáÊñ≠"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding CardReaderConnectionState}" Value="{x:Static cardReader:CardReaderConnectionState.Reconnecting}">
                                        <Setter Property="Text" Value="üîÑ"/>
                                        <Setter Property="Foreground" Value="{DynamicResource WarningActionBrush}"/>
                                        <Setter Property="ToolTip" Value="ÂÜçÊé•Á∂ö‰∏≠..."/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <!-- Êé•Á∂öÁä∂ÊÖã„ÉÜ„Ç≠„Çπ„Éà -->
                    <TextBlock VerticalAlignment="Center">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Text" Value="„É™„Éº„ÉÄ„Éº: Êé•Á∂ö‰∏≠"/>
                                <Setter Property="Foreground" Value="{DynamicResource SuccessActionBrush}"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding CardReaderConnectionState}" Value="{x:Static cardReader:CardReaderConnectionState.Disconnected}">
                                        <Setter Property="Text" Value="„É™„Éº„ÉÄ„Éº: ÂàáÊñ≠"/>
                                        <Setter Property="Foreground" Value="{DynamicResource ErrorBorderBrush}"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding CardReaderConnectionState}" Value="{x:Static cardReader:CardReaderConnectionState.Reconnecting}">
                                        <Setter Property="Text">
                                            <Setter.Value>
                                                <Binding Path="CardReaderReconnectAttempts" StringFormat="„É™„Éº„ÉÄ„Éº: ÂÜçÊé•Á∂ö‰∏≠ ({0}/10)"/>
                                            </Setter.Value>
                                        </Setter>
                                        <Setter Property="Foreground" Value="{DynamicResource WarningActionBrush}"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                    <!-- ÊâãÂãïÂÜçÊé•Á∂ö„Éú„Çø„É≥ÔºàÂàáÊñ≠ÊôÇ„ÅÆ„ÅøË°®Á§∫Ôºâ -->
                    <Button Content="ÂÜçÊé•Á∂ö"
                            Command="{Binding ReconnectCardReaderCommand}"
                            Margin="10,0,0,0"
                            Padding="8,2"
                            FontSize="{DynamicResource SmallFontSize}"
                            AutomationProperties.Name="„Ç´„Éº„Éâ„É™„Éº„ÉÄ„Éº„Å´ÂÜçÊé•Á∂ö"
                            ToolTip="„Ç´„Éº„Éâ„É™„Éº„ÉÄ„Éº„Å∏„ÅÆÊé•Á∂ö„ÇíÂÜçË©¶Ë°å„Åó„Åæ„Åô">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding CardReaderConnectionState}" Value="{x:Static cardReader:CardReaderConnectionState.Disconnected}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </StatusBarItem>
            <Separator/>
            <!-- „Éê„Éº„Ç∏„Éß„É≥Ë°®Á§∫ÔºàIssue #475Ôºâ -->
            <StatusBarItem HorizontalAlignment="Right"
                           AutomationProperties.Name="„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„Éê„Éº„Ç∏„Éß„É≥">
                <TextBlock Foreground="{DynamicResource SecondaryTextBrush}"
                           ToolTip="„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥„ÅÆ„Éê„Éº„Ç∏„Éß„É≥Áï™Âè∑">
                    <Run Text="Ver. "/>
                    <Run Text="{Binding Source={x:Static app:App.AppVersion}, Mode=OneTime}"/>
                </TextBlock>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
