# 画面設計書

## 1. 画面一覧

| No | 画面ID | 画面名 | 概要 |
|----|--------|--------|------|
| 1 | SCR-001 | メイン画面 | 待ち受け画面、貸出・返却メッセージ表示 |
| 2 | SCR-002 | 履歴表示画面 | 交通系ICカードの利用履歴一覧 |
| 3 | SCR-003 | 履歴詳細画面 | 履歴の詳細表示（ダイアログ） |
| 4 | SCR-004 | 履歴修正画面 | 履歴の修正（インライン編集） |
| 5 | SCR-005 | バス停入力画面 | バス利用区間の入力（ダイアログ） |
| 6 | SCR-006 | 月次帳票作成画面 | 月選択とExcel出力（ダイアログ） |
| 7 | SCR-007 | 交通系ICカード管理画面 | カードの登録・修正・削除 |
| 8 | SCR-008 | 職員証管理画面 | 職員証の登録・修正・削除 |
| 9 | SCR-009 | 設定画面 | 各種設定（ダイアログ） |
| 10 | SCR-010 | システム管理画面 | バックアップ復旧、ログ確認 |
| 11 | SCR-011 | カード登録確認画面 | 未登録カード検出時の確認（ダイアログ） |

## 2. 画面遷移図

```
                    ┌─────────────────┐
                    │   起動時処理     │
                    │  ・警告表示      │
                    │  ・バックアップ   │
                    └────────┬────────┘
                             │
                             ▼
┌────────────────────────────────────────────────────────────┐
│                    SCR-001 メイン画面                       │
│  ┌──────────────────────────────────────────────────────┐ │
│  │ [メニューバー]                                        │ │
│  │  設定 ─┬─ 交通系ICカード管理 ──▶ SCR-007            │ │
│  │        ├─ 職員証管理 ──────────▶ SCR-008            │ │
│  │        └─ 設定 ────────────────▶ SCR-009            │ │
│  │  システム管理 ────────────────────▶ SCR-010          │ │
│  │  月次帳票作成 ────────────────────▶ SCR-006          │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌──────────────────────────────────────────────────────┐ │
│  │                     中央表示エリア                     │ │
│  │                                                        │ │
│  │   貸出・返却時：職員証をタッチして、                    │ │
│  │               その後に交通系ICカードをタッチ            │ │
│  │   履歴確認・修正時：交通系ICカードのみをタッチ          │ │
│  │   その他：メニューから機能を選択                        │ │
│  │                                                        │ │
│  └──────────────────────────────────────────────────────┘ │
│                                                            │
│  ┌────────────────┐  ┌────────────────────────────────┐ │
│  │  警告エリア      │  │  通知エリア（右上）              │ │
│  │  ・バス停未入力  │  │  「いってらっしゃい！」          │ │
│  │  ・残額警告      │  │  「おかえりなさい！」            │ │
│  └────────────────┘  └────────────────────────────────┘ │
└────────────────────────────────────────────────────────────┘
         │                              │
         │ 交通系ICカードタッチ          │ 職員証→ICカードタッチ
         │ （職員証なし）                │
         ▼                              │
┌────────────────────┐                  │
│ SCR-002 履歴表示    │                  │
│  ├─▶ SCR-003 詳細  │                  │
│  └─▶ SCR-004 修正  │                  │
│       └─▶ SCR-005  │                  │
└────────────────────┘                  │
                                        │
         ┌──────────────────────────────┘
         │ バス利用あり
         ▼
┌────────────────────┐
│ SCR-005 バス停入力  │
└────────────────────┘
```

## 3. 画面詳細

---

### 3.1 SCR-001: メイン画面

#### 3.1.1 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────┐
│ [設定(S)] [システム管理(A)] [月次帳票作成(R)]                      │
├─────────────────────────────────────────────────────────────────┤
│                                          ┌───────────────────┐ │
│                                          │ 通知エリア         │ │
│                                          │                   │ │
│                                          └───────────────────┘ │
│                                                                 │
│                                                                 │
│     ┌─────────────────────────────────────────────────────┐   │
│     │                                                       │   │
│     │      貸出・返却時：職員証をタッチして、                 │   │
│     │                  その後に交通系ICカードをタッチ         │   │
│     │                                                       │   │
│     │      履歴確認・修正時：交通系ICカードのみをタッチ       │   │
│     │                                                       │   │
│     │      その他：メニューから機能を選択                    │   │
│     │                                                       │   │
│     └─────────────────────────────────────────────────────┘   │
│                                                                 │
│                                                                 │
│ ┌─────────────────────────────────────────────────────────────┐│
│ │ ⚠ バス停名が未入力の履歴があります（3件）      [詳細を見る] ││
│ │ ⚠ 残額が10,000円未満のカードがあります（No.2: 8,500円）     ││
│ └─────────────────────────────────────────────────────────────┘│
├─────────────────────────────────────────────────────────────────┤
│ 状態: 職員証タッチ待ち                                          │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.1.2 画面項目

| No | 項目名 | 種別 | 説明 |
|----|--------|------|------|
| 1 | メニューバー | メニュー | 設定、システム管理、月次帳票作成 |
| 2 | 通知エリア | ラベル | 貸出・返却時のメッセージ表示（右上） |
| 3 | 操作案内 | ラベル | 中央に大きく操作方法を表示 |
| 4 | 警告エリア | リスト | バス停未入力、残額警告を表示 |
| 5 | ステータスバー | ラベル | 現在の状態を表示 |

#### 3.1.3 通知エリアの表示パターン

| 状態 | メッセージ | 背景色 | 表示時間 |
|------|------------|--------|----------|
| 貸出成功 | 🚃→ いってらっしゃい！ | 薄いオレンジ (#FFE0B2) | 2秒 |
| 返却成功 | 🏠← おかえりなさい！ | 薄い水色 (#B3E5FC) | 2秒 |
| 職員証認識 | 職員証を確認しました。交通系ICカードをかざしてください。 | 白 | 継続 |
| エラー | （状況に応じたメッセージ） | 薄い赤 (#FFEBEE) | 継続 |

---

### 3.2 SCR-002: 履歴表示画面

#### 3.2.1 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────┐
│ 物品の分類: 雑品（金券類）  品名: はやかけん  規格: No.3        │
│ 単位: 円                                             頁: 1/3   │
├─────────────────────────────────────────────────────────────────┤
│ 出納年月日 │ 摘要              │受入│払出│ 残額  │氏名    │備考│操作│
├────────────┼───────────────────┼────┼────┼───────┼────────┼────┼────┤
│R7.11.05    │鉄道（祇園～福岡空港│    │ 957│13,446 │福岡太郎│    │[詳][修]│
│R7.11.04    │鉄道（祇園～福岡空港│    │ 957│14,403 │福岡太郎│    │[詳][修]│
│R7.11.02    │鉄道（祇園～西鉄香椎│    │ 840│15,360 │博多次郎│    │[詳][修]│
│R7.11.01    │鉄道（祇園～筑前前原│    │1280│16,200 │福岡太郎│    │[詳][修]│
│R7.10.31    │役務費によりチャージ│10000│   │18,420 │        │    │[灰][修]│
│R7.10.31    │鉄道（祇園～福岡空港│    │ 940│17,480 │福岡三郎│    │[詳][修]│
│...         │                   │    │    │       │        │    │        │
├─────────────────────────────────────────────────────────────────┤
│                     [前へ] [次へ]                    [閉じる]  │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.2.2 画面項目

| No | 項目名 | 種別 | 説明 |
|----|--------|------|------|
| 1 | ヘッダ情報 | ラベル | 物品分類、品名、規格、単位、頁 |
| 2 | 履歴一覧 | DataGrid | 履歴データ（最大100件/頁） |
| 3 | 詳細ボタン | ボタン | 履歴詳細画面を開く |
| 4 | 修正ボタン | ボタン | インライン編集モードへ |
| 5 | ページ送り | ボタン | 前へ/次へ |
| 6 | 閉じるボタン | ボタン | メイン画面に戻る |

#### 3.2.3 詳細ボタンの状態

- 詳細がない場合（利用/チャージが1件のみ）：グレーアウト、クリック不可

---

### 3.3 SCR-003: 履歴詳細画面（ダイアログ）

#### 3.3.1 画面レイアウト

```
┌───────────────────────────────────────────┐
│ 履歴詳細                            [×]  │
├───────────────────────────────────────────┤
│ 出納年月日: 令和7年11月5日                │
│ 利用者: 福岡太郎                          │
├───────────────────────────────────────────┤
│ 利用日時    │乗車駅         │降車駅       │金額 │残額   │
├─────────────┼───────────────┼─────────────┼─────┼───────┤
│11/05 09:15  │東京           │浜松町       │ 178 │14,225 │
│11/05 09:45  │モノレール浜松町│羽田第一ﾀｰﾐﾅﾙ│ 519 │13,706 │
│11/05 12:30  │福岡空港       │祇園         │ 260 │13,446 │
├───────────────────────────────────────────┤
│                                  [閉じる] │
└───────────────────────────────────────────┘
```

---

### 3.4 SCR-004: 履歴修正画面（インライン編集）

#### 3.4.1 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────┐
│ ...                                                             │
├────────────┼───────────────────┼────┼────┼───────┼────────┼────┼────┤
│R7.11.05    │鉄道（祇園～福岡空港│    │ 957│13,446 │福岡太郎│    │[詳][修]│
│████████████████████████████████████████████████████████████████│
│R7.11.04    │[                  ]│[   ]│[ ]│[     ]│[      ]│[  ]│[完了][ｷｬﾝｾﾙ]│
│████████████████████████████████████████████████████████████████│
│R7.11.02    │鉄道（祇園～西鉄香椎│    │ 840│15,360 │博多次郎│    │[詳][修]│
│...         │                   │    │    │       │        │    │        │
└─────────────────────────────────────────────────────────────────┘
```

#### 3.4.2 編集モードの動作

1. 「修正」ボタンクリック → 職員証タッチを促すダイアログ表示
2. 職員証タッチ後、当該行が編集モードに移行
3. 背景色を薄い黄色に変更
4. 各項目がテキストボックスに変化
5. 修正された項目は赤色太字で表示
6. 「完了」で保存、「キャンセル」で破棄

---

### 3.5 SCR-005: バス停入力画面（ダイアログ）

#### 3.5.1 画面レイアウト

```
┌───────────────────────────────────────────┐
│ バス利用区間の入力                  [×]  │
├───────────────────────────────────────────┤
│ 以下のバス利用について、利用区間を        │
│ 入力してください。                        │
├───────────────────────────────────────────┤
│ 利用日時: 2025/10/31 10:15                │
│ 利用額: 150円                             │
│                                           │
│ 利用区間: [駅前一丁目～薬院駅前        ]  │
│                                           │
├───────────────────────────────────────────┤
│ 利用日時: 2025/10/31 10:45                │
│ 利用額: 210円                             │
│                                           │
│ 利用区間: [薬院駅前～六本松            ]  │
│                                           │
├───────────────────────────────────────────┤
│           [後で入力] [完了]               │
└───────────────────────────────────────────┘
```

---

### 3.6 SCR-006: 月次帳票作成画面（ダイアログ）

#### 3.6.1 画面レイアウト

```
┌───────────────────────────────────────────┐
│ 月次帳票作成                        [×]  │
├───────────────────────────────────────────┤
│                                           │
│  対象月を選択してください:                │
│                                           │
│  ○ 先月（令和7年11月）                   │
│  ○ 今月（令和7年12月）                   │
│  ○ その他の月                            │
│     └─ [ 令和 ▼] [ 7 ▼] 年 [11 ▼] 月    │
│                                           │
│  対象カード:                              │
│  ☑ No.1 (はやかけん)                     │
│  ☑ No.2 (nimoca)                         │
│  ☑ No.3 (SUGOCA)                         │
│  □ 全て選択                              │
│                                           │
├───────────────────────────────────────────┤
│           [キャンセル] [Excelファイル作成] │
└───────────────────────────────────────────┘
```

---

### 3.7 SCR-007: 交通系ICカード管理画面

#### 3.7.1 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────┐
│ 交通系ICカード管理                                              │
├─────────────────────────────────────────────────────────────────┤
│ 登録済みカード一覧                                              │
├────────────┬────────────┬────────┬──────────────────────────────┤
│ 通し番号    │ カード種別  │ 状態   │ 操作                        │
├────────────┼────────────┼────────┼──────────────────────────────┤
│ No.1       │ はやかけん  │ 未貸出 │ [修正][削除]                │
│ No.2       │ nimoca     │ 貸出中 │ [修正][削除]                │
│ No.3       │ SUGOCA     │ 未貸出 │ [修正][削除]                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ 新規登録:                                                       │
│ 交通系ICカードをICカードリーダにかざしてください                 │
│                                                                 │
│ カード種別: [はやかけん ▼] (自動判別)                           │
│ 通し番号:   [        ]                                          │
│ 備考:       [                                      ]            │
│                                                                 │
│                                           [登録]                │
├─────────────────────────────────────────────────────────────────┤
│                                                        [閉じる] │
└─────────────────────────────────────────────────────────────────┘
```

---

### 3.8 SCR-008: 職員証管理画面

#### 3.8.1 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────┐
│ 職員証管理                                                      │
├─────────────────────────────────────────────────────────────────┤
│ 登録済み職員一覧                                                │
├──────────────────────────┬──────────────┬────────────────────────┤
│ 氏名                     │ 職員番号      │ 操作                  │
├──────────────────────────┼──────────────┼────────────────────────┤
│ 福岡太郎                 │ 001          │ [修正][削除]          │
│ 博多次郎                 │ 002          │ [修正][削除]          │
│ 福岡三郎                 │ 003          │ [修正][削除]          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ 新規登録:                                                       │
│ 職員証をICカードリーダにかざしてください                         │
│                                                                 │
│ 氏名:      [                  ]                                 │
│ 職員番号:  [        ]                                           │
│ 備考:      [                                      ]             │
│                                                                 │
│                                           [登録]                │
├─────────────────────────────────────────────────────────────────┤
│                                                        [閉じる] │
└─────────────────────────────────────────────────────────────────┘
```

---

### 3.9 SCR-009: 設定画面（ダイアログ）

#### 3.9.1 画面レイアウト

```
┌───────────────────────────────────────────┐
│ 設定                                [×]  │
├───────────────────────────────────────────┤
│                                           │
│ 残額警告:                                 │
│ 残額が [10000    ] 円未満で警告を表示     │
│                                           │
│ バックアップ先:                           │
│ [C:\ICCardManager\backup          ] [参照]│
│                                           │
│ 文字の大きさ:                             │
│ ○ 小  ○ 中  ○ 大  ○ 特大               │
│                                           │
├───────────────────────────────────────────┤
│             [キャンセル] [保存]           │
└───────────────────────────────────────────┘
```

---

### 3.10 SCR-010: システム管理画面

#### 3.10.1 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────┐
│ システム管理                                                    │
├─────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────────┐│
│ │ バックアップからの復旧                                      ││
│ │                                                             ││
│ │ バックアップ一覧:                                           ││
│ │ ┌─────────────────────────────────────────────────────┐   ││
│ │ │ backup_20251205_093015.db    2024/12/05 09:30:15    │   ││
│ │ │ backup_20251204_081230.db    2024/12/04 08:12:30    │   ││
│ │ │ backup_20251203_090045.db    2024/12/03 09:00:45    │   ││
│ │ │ ...                                                  │   ││
│ │ └─────────────────────────────────────────────────────┘   ││
│ │                                              [復旧を実行]   ││
│ └─────────────────────────────────────────────────────────────┘│
│                                                                 │
│ ┌─────────────────────────────────────────────────────────────┐│
│ │ 修正ログの確認                                              ││
│ │                                                             ││
│ │ 期間: [2024/12/01] ～ [2024/12/05]          [検索]         ││
│ │                                                             ││
│ │ ┌─────────────────────────────────────────────────────┐   ││
│ │ │ 日時                │操作者    │対象      │操作    │   ││
│ │ │ 2024/12/05 10:15:30 │福岡太郎  │ledger:15 │UPDATE  │   ││
│ │ │ 2024/12/04 14:22:10 │博多次郎  │staff:3   │INSERT  │   ││
│ │ │ ...                 │          │          │        │   ││
│ │ └─────────────────────────────────────────────────────┘   ││
│ │                                                 [詳細表示]  ││
│ └─────────────────────────────────────────────────────────────┘│
├─────────────────────────────────────────────────────────────────┤
│                                                        [閉じる] │
└─────────────────────────────────────────────────────────────────┘
```

---

### 3.11 SCR-011: カード登録確認画面（ダイアログ）

#### 3.11.1 画面レイアウト

```
┌───────────────────────────────────────────┐
│ 未登録カード                        [×]  │
├───────────────────────────────────────────┤
│                                           │
│  このカードは登録されていません。          │
│                                           │
│  このカードを登録しますか？               │
│                                           │
├───────────────────────────────────────────┤
│  [職員証として登録] [交通系ICカードとして登録] [キャンセル] │
└───────────────────────────────────────────┘
```

## 4. 共通UI要素

### 4.1 フォントサイズ設定

| 設定値 | ベースサイズ | 見出しサイズ |
|--------|-------------|-------------|
| 小 | 12pt | 16pt |
| 中 | 14pt | 18pt |
| 大 | 16pt | 20pt |
| 特大 | 18pt | 24pt |

### 4.2 色設計

| 用途 | 色 | カラーコード |
|------|-----|-------------|
| 貸出成功背景 | 薄いオレンジ | #FFE0B2 |
| 返却成功背景 | 薄い水色 | #B3E5FC |
| エラー背景 | 薄い赤 | #FFEBEE |
| 編集行背景 | 薄い黄色 | #FFFDE7 |
| 修正済み項目 | 赤色太字 | #D32F2F |
| 警告テキスト | オレンジ | #FF9800 |
| バス停未入力マーク | 赤色 | #F44336 |

### 4.3 効果音

| 操作 | 音 | ファイル |
|------|-----|---------|
| 職員証認識 | ピッ | beep_short.wav |
| 貸出成功 | ピッ | beep_short.wav |
| 返却成功 | ピピッ | beep_double.wav |
| エラー | ピー | beep_error.wav |
